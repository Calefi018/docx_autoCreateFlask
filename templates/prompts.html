{% extends "base.html" %}
{% block content %}
    <h1 style="margin-top:0;">Engenharia de Prompts</h1>
    <p style="color: var(--text-muted); margin-bottom: 30px;">Crie múltiplos "Cérebros" para a sua Inteligência Artificial.</p>

    <div class="card" style="border-top: 4px solid var(--primary);">
        <h3 style="margin-top: 0; display: flex; align-items: center; gap: 8px;"><i class="ph-fill ph-plus-circle"></i> Criar Novo Padrão</h3>
        <form method="POST">
            <input type="text" name="nome" placeholder="Nome (Ex: Padrão Administração)" required style="width: 100%; margin-bottom: 10px;">
            <textarea name="texto" rows="8" placeholder="Cole aqui todas as suas regras e as TAGS obrigatórias (ex: [START_RESUMO_MEMORIAL]...)" required></textarea>
            <button type="submit" class="btn" style="width: 100%; margin-top: 10px; padding: 15px;"><i class="ph-bold ph-floppy-disk"></i> Salvar Novo Cérebro</button>
        </form>
    </div>

    <h3 style="margin-top: 40px; display: flex; align-items: center; gap: 8px;"><i class="ph-fill ph-brain"></i> Cérebros Ativos</h3>
    {% for p in prompts %}
        <div class="card" style="{% if p.is_default %}border-left: 4px solid #f59e0b;{% endif %}">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <h3 style="margin: 0; color: #fff;">
                    {{ p.nome }} 
                    {% if p.is_default %}<span style="color: #f59e0b; font-size: 0.75em; padding: 4px 8px; background: rgba(245, 158, 11, 0.1); border-radius: 4px; margin-left: 8px; vertical-align: middle;">PADRÃO DO SISTEMA</span>{% endif %}
                </h3>
                {% if not p.is_default %}
                    <a href="/prompts/delete/{{ p.id }}" class="btn btn-danger" style="padding: 8px 15px;" onclick="event.preventDefault(); Swal.fire({title: 'Tem certeza?', text: 'Este prompt será apagado para sempre.', icon: 'warning', showCancelButton: true, background: '#1e2130', color: '#fff', confirmButtonColor: '#ef4444', confirmButtonText: 'Sim, apagar!'}).then((r) => { if(r.isConfirmed) window.location.href = this.href; })"><i class="ph-bold ph-trash"></i> Apagar</a>
                {% endif %}
            </div>
            
            <div style="background: rgba(15, 17, 26, 0.5); padding: 20px; border-radius: 8px; margin-top: 20px; max-height: 250px; overflow-y: auto; border: 1px solid var(--border);">
                <pre style="color: var(--text-muted); font-size: 0.85rem; margin: 0; white-space: pre-wrap; font-family: monospace;">{{ p.texto }}</pre>
            </div>
        </div>
    {% endfor %}
{% endblock %}